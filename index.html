<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assist Chat</title>
    <style>
@import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&display=swap');
</style>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

<style>
    /* Keyframe Animations */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes button-glow { 0%, 100% { box-shadow: 0 0 15px var(--shadow-color-heavy); } 50% { box-shadow: 0 0 30px var(--shadow-color-heavy); } }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Full Screen Page Container */
    #lucky-draw-page {
        position: fixed; inset: 0;
        background-color: white;
        z-index: 2000;
        display: flex; flex-direction: column;
        transform: translateY(100%);
        visibility: hidden;
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    #lucky-draw-page.visible { 
        transform: translateY(0); 
        visibility: visible;
    }

    .ld-header {
        padding: 1rem 1.5rem; flex-shrink: 0; text-align: right;
    }
    .icon-btn { background: none; border: none; font-size: 1.5rem; color: var(--secondary-text-color); cursor: pointer; }
    
    .ld-content-wrapper {
        flex-grow: 1; overflow-y: auto;
    }

    .ld-hero {
        padding: 2rem 1.5rem; text-align: center;
        background: var(--accent-gradient);
        color: white;
        border-bottom-left-radius: 2rem;
        border-bottom-right-radius: 2rem;
        position: relative;
        overflow: hidden;
    }
    .ld-hero i { font-size: 3rem; margin-bottom: 0.5rem; }
    .ld-hero h2 { font-size: 2.25rem; font-weight: 800; animation: fadeIn 0.5s 0.2s backwards; }
    .ld-hero p { font-size: 1.1rem; opacity: 0.8; animation: fadeIn 0.5s 0.4s backwards; }

    .ld-main-content { padding: 1.5rem; animation: fadeIn 0.5s 0.6s backwards; }
    .prize-grid {
        display: grid; grid-template-columns: 1fr 1fr;
        gap: 1rem; margin-bottom: 1.5rem;
    }
    .prize-card {
        background: var(--bg-color); padding: 1rem; border-radius: 1rem;
        text-align: center; border: 1px solid var(--border-color);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .prize-card:hover { transform: translateY(-4px); box-shadow: 0 5px 15px var(--shadow-color-light); }
    .prize-card .prize-title { font-size: 0.8rem; font-weight: 500; color: var(--secondary-text-color); }
    .prize-card .prize-amount { font-size: 1.25rem; font-weight: 700; color: var(--text-color); }
    .prize-card.special { grid-column: 1 / -1; }
    
    .ld-description { font-size: 0.9rem; color: var(--secondary-text-color); line-height: 1.6; margin-bottom: 1.5rem; text-align: center; }

    #lucky-draw-form input {
        width: 100%; padding: 1rem; margin-bottom: 1rem;
        border-radius: 0.75rem; border: 2px solid var(--border-color);
        background: var(--bg-color); font-family: inherit;
        font-size: 1rem; color: var(--text-color);
        transition: border-color 0.2s, box-shadow 0.2s;
    }
    #lucky-draw-form input:focus { 
        outline: none;
        border-color: var(--accent-color-start);
        box-shadow: 0 0 0 3px var(--shadow-color-light);
    }
    
    #lucky-draw-form button[type=submit] {
        width: 100%; padding: 1rem; border: none;
        border-radius: 0.75rem;
        background: var(--accent-color-start);
        color: white;
        font-size: 1.1rem; font-weight: 600; cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        animation: button-glow 3s infinite ease-in-out;
    }
    #lucky-draw-form button[type=submit]:hover { 
        transform: translateY(-2px); 
        box-shadow: 0 4px 20px var(--shadow-color-heavy); 
    }
    #lucky-draw-form button[type=submit]:disabled { 
        background: var(--secondary-text-color); 
        cursor: not-allowed; 
        transform: none; 
        box-shadow: none;
        animation: none;
    }
    #lucky-draw-form button[type=submit] i {
        font-size: 1.25rem;
        animation: spin 1s linear infinite;
    }
    
    .ld-footer {
        padding: 1.5rem; flex-shrink: 0;
    }
    .ld-footer label {
        display: flex; align-items: center; justify-content: center;
        font-size: 0.8rem; color: var(--secondary-text-color); cursor: pointer;
    }
    .ld-footer input { 
        margin-right: 0.5rem; 
        accent-color: var(--accent-color-start); 
    }
</style>

    <style>a.icon-btn{color:var(--secondary-text-color)}</style><script>document.addEventListener("DOMContentLoaded",()=>{let e=document.createElement("a");e.href="http://action_notifications",e.className="icon-btn",e.title="View Notifications",e.setAttribute("aria-label","View notifications"),e.innerHTML="<i class='bx bx-bell'></i>",document.querySelector(".header-actions")?.prepend(e)});</script>
    <style>.setting-link{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;text-decoration:none;color:var(--text-color)}.setting-link i{font-size:24px;color:var(--secondary-text-color)}</style><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.createElement("a");e.href="http://action_share",e.className="setting-link",e.innerHTML="<span>Share this app</span><i class='bx bx-share'></i>";const t=document.querySelector(".modal-content"),n=document.querySelector(".avatar-selection");t&&n?t.insertBefore(e,n):t?.appendChild(e)});</script>
    <!-- Highlight.js for Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="icon" type="image/png" href="https://i.ibb.co/KxHVdzfx/file-00000000b61061fb9d0784839d8d1309.png">
    <!-- Custom Stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body data-theme="light" >
<!-- START: Lucky Draw Feature Code -->
<div id="lucky-draw-page">
    <div class="ld-header">
        <button id="ld-close-btn" class="icon-btn" title="Close"><i class='bx bx-x'></i></button>
    </div>

    <div class="ld-content-wrapper">
        <div class="ld-hero">
            <i class='bx bxs-party'></i>
            <h2>3-Day Lucky Draw!</h2>
            <p>Win Real Cash Rewards!</p>
        </div>

        <div class="ld-main-content">
            <div class="prize-grid">
                <div class="prize-card">
                    <div class="prize-title">1st Prize</div>
                    <div class="prize-amount">1500 PKR</div>
                </div>
                <div class="prize-card">
                    <div class="prize-title">2nd Prize</div>
                    <div class="prize-amount">1000 PKR</div>
                </div>
                <div class="prize-card">
                    <div class="prize-title">3rd Prize</div>
                    <div class="prize-amount">750 PKR</div>
                </div>
                <div class="prize-card">
                    <div class="prize-title">4th Prize</div>
                    <div class="prize-amount">500 PKR</div>
                </div>
                <div class="prize-card special">
                    <div class="prize-title">Special Random Prize</div>
                    <div class="prize-amount">10 – 499 PKR</div>
                </div>
            </div>

            <p class="ld-description">
                This offer is for a limited time. The process is fair and transparent — no tricks, just pure luck. 
                Secure your entry today before the deadline ends!
            </p>

            <form id="lucky-draw-form">
                <input type="text" id="ld-name" placeholder="Your Name" required>
                <input type="email" id="ld-email" placeholder="Your Email Address" required>
                <input type="tel" id="ld-phone" placeholder="Phone (e.g., 03001234567)" pattern="03[0-9]{9}" title="Please enter a valid Pakistani mobile number" required>
                <button type="submit">Secure My Entry!</button>
            </form>

            <div class="ld-footer">
                <label>
                    <input type="checkbox" id="ld-dont-show">
                    Don't show this again
                </label>
            </div>
        </div>
    </div>
</div>
<!-- END: Lucky Draw Feature Code -->
    <div class="chat-widget" role="application">
        <header class="chat-header">
            <div class="header-icon" aria-hidden="true"><i class='bx bxs-star'></i></div>
            <h2 id="chat-title">Saba - Your Ultimate Friend</h2>
            <div class="header-actions">
                <button class="icon-btn" id="clear-chat-btn" title="Clear Chat History" aria-label="Clear all messages">
                    <i class='bx bxs-trash'></i>
                </button>
                <button class="icon-btn" id="settings-btn" title="Open Settings" aria-label="Open settings panel">
                    <i class='bx bxs-cog'></i>
                </button>
            </div>
        </header>
        
        <main class="chat-body" id="chat-body" role="log" aria-live="polite">
            <div class="initial-view" id="initial-view">
                <div class="initial-icon-container">
    <img src="https://i.ibb.co/v6GqL1hF/1000033976.jpg" alt="Saba Assistant">
</div>
                <h3>How can I help you?</h3>
                <p>Ask me anything, attach an image, or use your voice.</p>
            </div>
            <div class="conversation-view" id="conversation-view"></div>
        </main>
        
        <div id="image-preview-area"></div>
        <div id="record-status" role="status" aria-live="assertive">
            <div class="red-dot" aria-hidden="true"></div>
            <span>Listening...</span>
        </div>

        <footer class="chat-input-area" role="form">
            <input type="file" id="image-upload" accept="image/png, image/jpeg, image/webp" hidden>
            <input type="file" id="file-upload" hidden>
            
            <!-- 
            
            <button class="icon-btn" id="attachment-btn" title="Attach a file" aria-label="Attach file or image">
                <i class='bx bx-paperclip'></i>
            </button>
            
             -->
            
            <div class="input-wrapper">
                <button class="icon-btn" id="attachment-btn" title="Attach a file" aria-label="Attach file or image">
                <i class='bx bx-paperclip bs'></i>
            </button>
                 <textarea id="message-input" placeholder="Ask me anything..." rows="2" aria-label="Message input"></textarea>
            </div>
           
            <button id="send-btn" class="input-action-btn hidden" title="Send Message" aria-label="Send message">
                <i class='bx bx-paper-plane'></i>
            </button>
            <button id="mic-btn" onclick="alert('This features is comming soon')"class="input-action-btn" style="pointer-events: none; opacity: 0.8; cursor: not-allowed;" title="Use Speech-to-Text" aria-label="Activate speech to text">
                <i class='bx bx-microphone'></i>
            </button>
        </footer>
        
        <div id="attachment-modal-overlay" class="modal-overlay-custom" aria-hidden="true"></div>
        <div id="attachment-modal-content" role="dialog" aria-modal="true">
            <div class="attachment-option" id="attach-image-btn" role="button" tabindex="0">
                <div class="icon"><i class='bx bxs-image'></i></div>
                <span>Image</span>
            </div>
            <div class="attachment-option disabled" id="attach-file-btn" role="button" tabindex="0" style="pointer-events: none; opacity: 0.8; cursor: not-allowed;">
    <div class="icon" style="pointer-events: none; opacity: 0.8; cursor: not-allowed;"><i class='bx bxs-file'></i></div>
    <span style="pointer-events: none; color: black; opacity: 1; cursor: not-allowed;">File</span>
    <span>Very Soon</span>
</div>
        </div>
    </div>

    <div class="modal-overlay" id="settings-modal" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button class="icon-btn" id="close-modal-btn" aria-label="Close settings">&times;</button>
            </div>
            
            <div class="setting-item">
                <label for="theme-toggle">Dark Mode</label>
                <label class="theme-switch">
                    <input type="checkbox" id="theme-toggle" role="switch">
                    <span class="slider"></span>
                </label>
            </div>
            
            <div class="avatar-selection">
                <label id="avatar-label">Your Avatar</label>
                <div class="avatar-presets" role="radiogroup"></div>
                <input type="text" id="avatar-url-input" placeholder="Or paste an image URL" aria-label="Custom avatar URL">
            </div>
        </div>
    </div>
    
    <!-- Add this right before your closing </body> tag -->

<!-- Command Helper Popup -->
<div id="command-helper" class="command-helper"></div>

<!-- Universal Modal for Fullscreen Images and Videos -->
<div id="fullscreen-modal" class="modal-overlay">
    <div class="modal-content">
        <button id="modal-close-btn" class="modal-action-btn">&times;</button>
        <button id="modal-fullscreen-btn" class="modal-action-btn"><i class='bx bx-fullscreen'></i></button>
        <button id="modal-miniplayer-btn" class="modal-action-btn"><i class='bx bx-windows'></i></button>
        <div id="modal-body" class="modal-body">
            <!-- Content (image or video iframe) will be injected here by JS -->
        </div>
    </div>
</div>
    
    <div id="toast-container" role="alert" aria-live="assertive"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="ai_studio_code (9).js"></script>
    <script>
        document.querySelectorAll('.message-content').forEach(el => {
  if (/[؀-ۿ]/.test(el.textContent)) {  // Urdu/Arabic unicode range
    el.style.fontFamily = '"Noto Sans Arabic", serif';
  } else {
    el.style.fontFamily = '"Edu NSW ACT Cursive", cursive';
  }
});
    </script>
    <script src="extras.js"></script>
    <script src="sysp.js"></script>
    <script>
  const attachBtn = document.getElementById("attach-file-btn");
  let clickCount = 0;

  attachBtn.addEventListener("click", () => {
    clickCount++;

    if (clickCount === 2) {
      alert("This feature is coming soon");
      clickCount = 0; // reset so it works again if user clicks twice later
    }
  });
</script>
    <script>document.getElementById('message-input').addEventListener('keydown', e => { if (e.key === 'Enter' && !e.shiftKey) { e.stopImmediatePropagation(); document.getElementById('message-input').dispatchEvent(new Event('input')); } }, true);</script>
    
<script>
document.addEventListener("DOMContentLoaded",() => {
    // --- 1. CONFIGURATION: REPLACE WITH YOUR SUPABASE KEYS ---
    const SUPABASE_URL = "https://txdeqplbrfxpvzdlcocd.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR4ZGVxcGxicmZ4cHZ6ZGxjb2NkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY0NTUyMjgsImV4cCI6MjA3MjAzMTIyOH0.FVBcegrBjwuF_t0AV2Y7n9oCMv8hmFWTE91-Emx2-7Y";
    
    // --- 2. DOM ELEMENTS ---
    const elements = {
        page: document.getElementById("lucky-draw-page"),
        form: document.getElementById("lucky-draw-form"),
        nameInput: document.getElementById("ld-name"),
        emailInput: document.getElementById("ld-email"),
        phoneInput: document.getElementById("ld-phone"),
        dontShowCheckbox: document.getElementById("ld-dont-show"),
        closeBtn: document.getElementById("ld-close-btn"),
    };
    
    const STORAGE_KEY = 'luckyDrawStateV3';

    // --- 3. CORE FUNCTIONS ---
    function showPage() {
        if (!elements.page) return;
        elements.page.classList.add("visible");
    }

    function hidePage() {
        if (!elements.page) return;
        elements.page.classList.remove("visible");
    }

    function handleClose() {
        if (elements.dontShowCheckbox.checked) {
            localStorage.setItem(STORAGE_KEY, 'dismissed_permanently');
        } else {
            sessionStorage.setItem(STORAGE_KEY, 'dismissed_session');
        }
        hidePage();
    }
    
    async function handleFormSubmit(e) {
        e.preventDefault();
        const submitBtn = elements.form.querySelector("button[type=submit]");
        submitBtn.disabled = true;
        submitBtn.innerHTML = "<i class='bx bx-loader-alt'></i> Submitting...";

        try {
            if (!SUPABASE_URL || SUPABASE_URL === "YOUR_SUPABASE_URL") {
                throw new Error("Supabase URL is not configured in the script.");
            }
            
            const participantData = {
                name: elements.nameInput.value,
                email: elements.emailInput.value,
                phone: elements.phoneInput.value,
                system_info: navigator.userAgent
            };

            const response = await fetch(`${SUPABASE_URL}/rest/v1/participants`, {
                method: "POST",
                headers: {
                    "apikey": SUPABASE_ANON_KEY,
                    "Authorization": `Bearer ${SUPABASE_ANON_KEY}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(participantData)
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || "Could not submit entry. Please try again.");
            }

            submitBtn.style.background = "linear-gradient(45deg, #28a745, #218838)";
            submitBtn.textContent = "Thank You & Good Luck!";
            localStorage.setItem(STORAGE_KEY, 'dismissed_permanently');
            
            setTimeout(hidePage, 2000);

        } catch (error) {
            console.error("Submission error:", error);
            submitBtn.style.background = "linear-gradient(45deg, #dc3545, #c82333)";
            submitBtn.textContent = "Submission Failed";
            
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.style.background = "";
                submitBtn.textContent = "Secure My Entry!";
            }, 3000);
        }
    }
    
    // --- 4. INITIALIZATION ---
    const permanentState = localStorage.getItem(STORAGE_KEY);
    const sessionState = sessionStorage.getItem(STORAGE_KEY);

    if (permanentState !== 'dismissed_permanently' && sessionState !== 'dismissed_session') {
       setTimeout(showPage, 2500); // Show after a 2.5-second delay
    }

    // --- 5. EVENT LISTENERS ---
    elements.closeBtn.addEventListener("click", handleClose);
    elements.form.addEventListener("submit", handleFormSubmit);
});
</script>
 </body>
</html>
        
